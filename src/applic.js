applic.__proto__.import={};var _toBlobUri=function _toBlobUri(_file){var _reader=window.URL||window.webkitURL;return"".concat(_reader.createObjectURL(_file))};applic.import.traverse=function(_params){return new(function(){function _class2(){var _this=this;babelHelpers.classCallCheck(this,_class2);this.types=_params.types||[];this.blobs={};this.onRegistered=function(){};this.onChanged=function(){};this.onResolved=function(){};this.onRejected=function(){};Promise.resolve().then(function(){var _files=0,_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _iterator=_params.files[Symbol.iterator](),_step,_file;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){_file=_step.value;if(_file.type&&""!=_file.type)_files++}}catch(err){_didIteratorError=!0;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&null!=_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}};if(_files<_params.files.length&&_params.items){babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function _callee(){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _this._traverse({items:_params.items});case 2:applic.utils.buffer(_this._resolve.bind(_this));case 3:case"end":return _context.stop();}}},_callee)}))()}else{_this._resolveFiles({files:_params.files})};})}babelHelpers.createClass(_class2,[{key:"_traverse",value:function _traverse(_iteration){var _this2=this;return new Promise(function(){var _ref2=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function _callee3(resolve){var _iteratorNormalCompletion2,_didIteratorError2,_iteratorError2,_iterator2,_step2,_item,_iteratorNormalCompletion3,_didIteratorError3,_iteratorError3,_loop,_iterator3,_step3,_ret;return regeneratorRuntime.wrap(function _callee3$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!_iteration.entries)_iteration.entries=[];if(!_iteration.depth)_iteration.depth=0;if(!_iteration.items){_context4.next=23;break}_iteratorNormalCompletion2=!0;_didIteratorError2=!1;_iteratorError2=void 0;_context4.prev=6;for(_iterator2=_iteration.items[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){_item=_step2.value;_iteration.entries.push(_item.webkitGetAsEntry())}_context4.next=14;break;case 10:_context4.prev=10;_context4.t0=_context4["catch"](6);_didIteratorError2=!0;_iteratorError2=_context4.t0;case 14:_context4.prev=14;_context4.prev=15;if(!_iteratorNormalCompletion2&&null!=_iterator2.return){_iterator2.return()}case 17:_context4.prev=17;if(!_didIteratorError2){_context4.next=20;break}throw _iteratorError2;case 20:return _context4.finish(17);case 21:return _context4.finish(14);case 22:;case 23:;_iteratorNormalCompletion3=!0;_didIteratorError3=!1;_iteratorError3=void 0;_context4.prev=27;_loop=regeneratorRuntime.mark(function _loop(){var _entry;return regeneratorRuntime.wrap(function _loop$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_entry=_step3.value;if(_entry){_context3.next=3;break}return _context3.abrupt("return",{v:void 0});case 3:if(!_entry.isFile){_context3.next=11;break}_context3.t0=_this2;_context3.next=7;return new Promise(function(resolve){_entry.file(function(_file){resolve(_file)})});case 7:_context3.t1=_context3.sent;_context3.t0._register.call(_context3.t0,_context3.t1);_context3.next=16;break;case 11:if(!(_entry.isDirectory&&5>_iteration.depth)){_context3.next=16;break}_context3.next=14;return new Promise(function(resolve){_entry.createReader().readEntries(function(){var _ref3=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function _callee2(_entries){return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _this2._traverse({entries:_entries,depth:++_iteration.depth});case 2:resolve();case 3:case"end":return _context2.stop();}}},_callee2)}));return function(_x2){return _ref3.apply(this,arguments)}}())});case 14:_context3.next=16;break;case 16:case"end":return _context3.stop();}}},_loop)});_iterator3=_iteration.entries[Symbol.iterator]();case 30:if(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done){_context4.next=38;break}return _context4.delegateYield(_loop(),"t1",32);case 32:_ret=_context4.t1;if(!("object"===babelHelpers.typeof(_ret))){_context4.next=35;break}return _context4.abrupt("return",_ret.v);case 35:_iteratorNormalCompletion3=!0;_context4.next=30;break;case 38:_context4.next=44;break;case 40:_context4.prev=40;_context4.t2=_context4["catch"](27);_didIteratorError3=!0;_iteratorError3=_context4.t2;case 44:_context4.prev=44;_context4.prev=45;if(!_iteratorNormalCompletion3&&null!=_iterator3.return){_iterator3.return()}case 47:_context4.prev=47;if(!_didIteratorError3){_context4.next=50;break}throw _iteratorError3;case 50:return _context4.finish(47);case 51:return _context4.finish(44);case 52:;resolve();case 54:case"end":return _context4.stop();}}},_callee3,null,[[6,10,14,22],[15,,17,21],[27,40,44,52],[45,,47,51]])}));return function(_x){return _ref2.apply(this,arguments)}}())}},{key:"_register",value:function _register(_file){var _nonce=applic.utils.nonce();if(-1==this.types.indexOf(_file.type)){this.onRejected({type:_file.type,name:escape(_file.name)})}else{this.blobs[_nonce]={file:_file,nonce:_nonce,detail:{name:escape(_file.name),type:escape(_file.type),lastModified:new Date(_file.lastModified)}};this.onRegistered({blob:this.blobs[_nonce]})}}},{key:"_resolve",value:function(){var _resolve2=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function _callee4(){var _nonce;return regeneratorRuntime.wrap(function _callee4$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.t0=regeneratorRuntime.keys(this.blobs);case 1:if((_context5.t1=_context5.t0()).done){_context5.next=9;break}_nonce=_context5.t1.value;_context5.next=5;return _toBlobUri(this.blobs[_nonce].file);case 5:this.blobs[_nonce].uri=_context5.sent;this.onChanged({blob:this.blobs[_nonce]});_context5.next=1;break;case 9:;this.onResolved();case 11:case"end":return _context5.stop();}}},_callee4,this)}));function _resolve(){return _resolve2.apply(this,arguments)}return _resolve}()},{key:"_resolveFiles",value:function _resolveFiles(_iteration){var _iteratorNormalCompletion4=!0,_didIteratorError4=!1,_iteratorError4=void 0;try{for(var _iterator4=_iteration.files[Symbol.iterator](),_step4,_file;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=!0){_file=_step4.value;this._register(_file)}}catch(err){_didIteratorError4=!0;_iteratorError4=err}finally{try{if(!_iteratorNormalCompletion4&&null!=_iterator4.return){_iterator4.return()}}finally{if(_didIteratorError4){throw _iteratorError4}}};this._resolve()}}]);return _class2}())};var GRAPHIC_STATE={};applic.graphic=new(function(){function _class3(){babelHelpers.classCallCheck(this,_class3)}return _class3}());applic.graphic.__proto__.updated=function(){};applic.graphic.get=function(_nonce){if("*"==_nonce){return applic.utils.arrayify(GRAPHIC_STATE)}else{return GRAPHIC_STATE[_nonce]||!1}};applic.graphic.select=function(_nonce){if(!GRAPHIC_STATE[_nonce])return};applic.graphic.remove=function(_nonce){if(!GRAPHIC_STATE[_nonce])return;delete GRAPHIC_STATE[_nonce];applic.utils.buffer(function(){applic.dispatch("applic:updated")})};applic.graphic.create=function(_params){return new(function(){function ApplicGraphic(){babelHelpers.classCallCheck(this,ApplicGraphic);this.nonce=applic.utils.nonce();this.section=_params.section;this.blob=_params.blob;this.detail=_params.blob.detail;GRAPHIC_STATE[this.nonce]=this;applic.dispatch("applic:updated")}babelHelpers.createClass(ApplicGraphic,[{key:"update",value:function update(_params){if(_params.section)this.section=_params.section;if(_params.blob)this.blob=_params.blob;this._changed()}},{key:"_changed",value:function _changed(){this.uri=this.uri||this.blob.uri||!1;applic.utils.buffer(function(){applic.dispatch("applic:updated")})}}]);return ApplicGraphic}())};var SECTION_STATE={};applic.section=new(function(){function _class4(){babelHelpers.classCallCheck(this,_class4)}return _class4}());applic.section.__proto__.updated=function(){};applic.section.get=function(){return applic.utils.arrayify(SECTION_STATE)};applic.section.select=function(){};applic.section.remove=function(){};applic.section.create=function(){_register(new function ApplicSection(){babelHelpers.classCallCheck(this,ApplicSection);this.nonce=applic.utils.nonce()})};var _register=function _register(_class){SECTION_STATE[_class.nonce]=_class;applic.section.updated()};console.info("applic:loaded","".concat(Date.now()-applic.created,"ms"));new(function(){function _class5(){babelHelpers.classCallCheck(this,_class5);applic.graphic.__proto__.updated=this.updated.bind(this);applic.section.__proto__.updated=this.updated.bind(this);applic.utils.buffer(this.updated.bind(this));console.debug("applic:ready","".concat(Date.now()-applic.created,"ms"))}babelHelpers.createClass(_class5,[{key:"updated",value:function updated(){this.sections=applic.section.get();this.graphics=applic.graphic.get();if(this._debug()){applic.dispatch("applic:updated",this);console.debug("applic:updated")}}},{key:"_debug",value:function _debug(){if(1>this.sections.length){console.debug("applic:debug","\"no sections\"");applic.section.create();return!1};return!0}}]);return _class5}());applic.__proto__.newImport=function(_params){return new(function(){function _class6(){babelHelpers.classCallCheck(this,_class6);this.graphic={};this.section=null}babelHelpers.createClass(_class6,[{key:"add",value:function add(_blob){this.graphic[_blob.nonce]=applic.graphic.new({section:this.section,blob:_blob})}},{key:"update",value:function update(_blob){this.graphic[_blob.nonce].update({blob:_blob})}},{key:"resolved",value:function resolved(){}}]);return _class6}())};